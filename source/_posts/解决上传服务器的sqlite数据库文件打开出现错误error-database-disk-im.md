---
title: 解决上传服务器的sqlite数据库文件打开出现错误error-database-disk-im
tags:
  - SQLite
id: 313771
categories:
  - 个人日志
date: 2014-03-15 02:31:43
---

在本地服务器通过php创建sqlite数据库，或者通过工具比如sqliteadmin创建的sqlite数据库，使用是正常的，但如果上传到服务器上，再通过php打开会现错误：Error: database disk image is malformed， 提示你的数据库文件有损坏，以前一直找不到原因，今天从同事那儿得到解决办法，原来是因为自己使用FTP工具 filezilla上传数据库文件时没有更改传输模式，我使用的是默认，改为二进制模式即可解决此问题，另外，你把数据库压缩成zip格式后，再上传也能解决此问题。

### FTP的传输有两种方式：ASCII传输模式和二进制数据传输模式。

1．ASCII传输方式：假定用户正在拷贝的文件包含的简单ASCII码文本，如果在远程机器上运行的不是UNIX，当文件传输时ftp通常会自动地调整文件的内容以便于把文件解释成另外那台计算机存储文本文件的格式。

但是常常有这样的情况，用户正在传输的文件包含的不是文本文件，它们可能是程序，数据库，字处理文件或者压缩文件（尽管字处理文件包含的大部分是文本，其中也包含有指示页尺寸，字库等信息的非打印字符）。在拷贝任何非文本文件之前，用binary 命令告诉ftp逐字拷贝，不要对这些文件进行处理，这也是下面要讲的二进制传输。

2．二进制传输模式：在二进制传输中，保存文件的位序，以便原始和拷贝的是逐位一一对应的。即使目的地机器上包含位序列的文件是没意义的。例如，macintosh以二进制方式传送可执行文件到IBM VM系统，在对方系统上，此文件不能执行。（但是，它可以从VM系统上以二进制方式拷贝到另一macintosh，是可以执行的）。

如果你在ASCII方式下传输二进制文件，即使不需要也仍会转译。这会使传输稍微变慢 ，也会损坏数据，使文件变得不能用。（在大多数计算机上，ASCII方式一般假设每一字符的第一有效位无意义，因为ASCII字符组合不使用它。如果你传输二进制文件，所有的位都是重要的。）如果你知道这两台机器是同样的，则二进制方式对文本文件和数据文件都是有效的。

**数据库文件记得使用二进制模式!**